# Docusaurus Migration Plan for NVIDIA Dynamo Documentation

> **Date:** January 2026  
> **Status:** Approved  
> **Decision:** Full Migration (Option A) with Native Versioning

---

## Table of Contents

1. [Executive Summary](#executive-summary)
2. [Current State Analysis](#current-state-analysis)
3. [Migration Approach](#migration-approach)
4. [Local Development & Testing](#local-development--testing)
5. [Project Structure](#project-structure)
6. [Content Migration](#content-migration)
7. [Versioning Strategy](#versioning-strategy)
8. [Theme & Styling](#theme--styling)
9. [Implementation Steps](#implementation-steps)
10. [Migration Checklist](#migration-checklist)

---

## Executive Summary

Full migration from Sphinx to Docusaurus, replacing the existing documentation build system entirely. This approach uses Docusaurus native versioning and focuses on local development/testing before any deployment decisions.

### Key Decisions

| Decision | Choice |
|----------|--------|
| **Migration Approach** | Option A: Full Docusaurus Migration |
| **Versioning** | Docusaurus Native (`docs:version` command) |
| **Deployment** | TBD (local testing first) |
| **Theme** | Custom CSS on Classic Theme (NVIDIA branding) |

### Goals

- ✅ Complete replacement of Sphinx
- ✅ Native versioned documentation
- ✅ Local preview in browser for testing
- ✅ Modern developer experience with hot reload
- ✅ MDX support for interactive documentation

---

## Current State Analysis

### Existing Infrastructure

| Component | Current Implementation |
|-----------|----------------------|
| **Framework** | Sphinx 7.x with nvidia_sphinx_theme |
| **Content Format** | RST (index.rst) + Markdown (MyST parser) |
| **Extensions** | mermaid, sphinx_design, ablog, sphinx_tabs, etc. |
| **Build System** | Makefile + Docker (container/Dockerfile.docs) |
| **CI/CD** | `.github/workflows/generate-docs.yml` (612 lines) |

### Files to Migrate

| Category | Files | Format |
|----------|-------|--------|
| Entry point | `index.rst` | RST → MDX |
| Configuration | `conf.py`, `Makefile` | → `docusaurus.config.ts` |
| Content | ~100+ docs | Markdown (mostly compatible) |
| Includes | `_includes/*.rst` | RST → MDX components |
| Extensions | `_extensions/github_alerts.py` | → MDX/Admonitions |
| Static assets | `_static/*`, `images/*` | → `static/` |

---

## Migration Approach

### Full Docusaurus Migration

Complete replacement of Sphinx with Docusaurus, migrating all content.

**Benefits:**
- Clean break from legacy system
- Modern React-based stack
- Native versioning built-in
- Fast hot-reload development server
- Better search capabilities
- MDX support for interactive docs

**New Structure:**
```
docs/
├── docusaurus/                  # New Docusaurus project
│   ├── docusaurus.config.ts     # Main configuration
│   ├── sidebars.ts              # Navigation structure
│   ├── package.json             # Dependencies
│   ├── tsconfig.json
│   ├── docs/                    # Current version documentation
│   │   ├── intro.md
│   │   ├── backends/
│   │   ├── kubernetes/
│   │   ├── guides/
│   │   └── ...
│   ├── versioned_docs/          # Auto-generated by Docusaurus
│   │   ├── version-0.3.0/
│   │   └── version-0.2.0/
│   ├── versioned_sidebars/
│   ├── src/
│   │   ├── components/          # Custom React components
│   │   ├── css/
│   │   │   └── custom.css       # NVIDIA theme overrides
│   │   └── pages/
│   ├── static/
│   │   └── img/
│   └── versions.json            # Version manifest
└── sphinx/                      # Old Sphinx docs (to be removed after migration)
```

---

## Local Development & Testing

### Quick Start

```bash
# Navigate to docs directory
cd docs/docusaurus

# Install dependencies
npm install

# Start development server with hot reload
npm run start
# Opens http://localhost:3000 in your browser

# Build static site (for testing production build)
npm run build

# Serve the production build locally
npm run serve
# Opens http://localhost:3000 with production build
```

### Development Commands

| Command | Description |
|---------|-------------|
| `npm run start` | Start dev server with hot reload (http://localhost:3000) |
| `npm run build` | Build production static site to `build/` |
| `npm run serve` | Serve production build locally |
| `npm run clear` | Clear Docusaurus cache |
| `npm run docusaurus docs:version X.Y.Z` | Create a new version snapshot |

### Testing Workflow

1. **Make changes** to docs in `docs/docusaurus/docs/`
2. **View instantly** at http://localhost:3000 (hot reload)
3. **Test production build:**
   ```bash
   npm run build && npm run serve
   ```
4. **Open browser** to http://localhost:3000 to verify

---

## Project Structure

### Initial Setup

```bash
# Create Docusaurus project
cd docs
npx create-docusaurus@latest docusaurus classic --typescript

# Install additional plugins
cd docusaurus
npm install @docusaurus/theme-mermaid
npm install @docusaurus/plugin-client-redirects
```

### Configuration Files

#### `docusaurus.config.ts`

```typescript
import {themes as prismThemes} from 'prism-react-renderer';
import type {Config} from '@docusaurus/types';
import type * as Preset from '@docusaurus/preset-classic';

const config: Config = {
  title: 'NVIDIA Dynamo',
  tagline: 'High-performance, low-latency inference framework',
  favicon: 'img/favicon.ico',
  
  // For local testing, use localhost
  url: 'http://localhost:3000',
  baseUrl: '/',
  
  organizationName: 'ai-dynamo',
  projectName: 'dynamo',
  
  onBrokenLinks: 'warn',
  onBrokenMarkdownLinks: 'warn',
  
  i18n: {
    defaultLocale: 'en',
    locales: ['en'],
  },
  
  markdown: {
    mermaid: true,
  },
  
  themes: ['@docusaurus/theme-mermaid'],
  
  presets: [
    [
      'classic',
      {
        docs: {
          routeBasePath: '/',  // Docs at root
          sidebarPath: './sidebars.ts',
          editUrl: 'https://github.com/ai-dynamo/dynamo/tree/main/docs/docusaurus/',
          showLastUpdateTime: true,
          // Versioning config
          lastVersion: 'current',
          versions: {
            current: {
              label: 'dev',
              path: 'dev',
            },
          },
        },
        blog: false,  // Disable blog
        theme: {
          customCss: './src/css/custom.css',
        },
      } satisfies Preset.Options,
    ],
  ],

  plugins: [
    [
      '@docusaurus/plugin-client-redirects',
      {
        redirects: [
          // Preserve existing redirects from Sphinx
          {from: '/guides/tool-calling', to: '/agents/tool-calling'},
          {from: '/architecture/architecture', to: '/design_docs/architecture'},
          // Add more as needed
        ],
      },
    ],
  ],

  themeConfig: {
    navbar: {
      title: 'NVIDIA Dynamo',
      logo: {
        alt: 'NVIDIA Logo',
        src: 'img/nvidia-logo.svg',
      },
      items: [
        {
          type: 'docsVersionDropdown',
          position: 'right',
          dropdownActiveClassDisabled: true,
        },
        {
          href: 'https://github.com/ai-dynamo/dynamo',
          label: 'GitHub',
          position: 'right',
        },
      ],
    },
    footer: {
      style: 'dark',
      links: [
        {
          title: 'Documentation',
          items: [
            {label: 'Getting Started', to: '/'},
            {label: 'Backends', to: '/backends'},
            {label: 'Kubernetes', to: '/kubernetes'},
          ],
        },
        {
          title: 'Community',
          items: [
            {label: 'GitHub', href: 'https://github.com/ai-dynamo/dynamo'},
            {label: 'Issues', href: 'https://github.com/ai-dynamo/dynamo/issues'},
          ],
        },
      ],
      copyright: `Copyright © ${new Date().getFullYear()} NVIDIA Corporation & Affiliates`,
    },
    prism: {
      theme: prismThemes.github,
      darkTheme: prismThemes.dracula,
      additionalLanguages: ['bash', 'python', 'yaml', 'rust', 'toml', 'json'],
    },
  } satisfies Preset.ThemeConfig,
};

export default config;
```

#### `sidebars.ts`

```typescript
import type {SidebarsConfig} from '@docusaurus/plugin-content-docs';

const sidebars: SidebarsConfig = {
  docs: [
    'intro',
    {
      type: 'category',
      label: 'Getting Started',
      items: [
        'installation',
        'quickstart',
        'support-matrix',
      ],
    },
    {
      type: 'category',
      label: 'Backends',
      items: [
        'backends/index',
        {
          type: 'category',
          label: 'SGLang',
          items: [
            'backends/sglang/index',
            'backends/sglang/gpt-oss',
          ],
        },
        {
          type: 'category',
          label: 'vLLM',
          items: [
            'backends/vllm/index',
          ],
        },
        {
          type: 'category',
          label: 'TensorRT-LLM',
          items: [
            'backends/trtllm/index',
          ],
        },
      ],
    },
    {
      type: 'category',
      label: 'Kubernetes',
      items: [
        'kubernetes/deployment',
        'kubernetes/observability',
        'kubernetes/multinode',
      ],
    },
    {
      type: 'category',
      label: 'User Guides',
      items: [
        'agents/tool-calling',
        'multimodal/index',
        'performance/tuning',
        'observability/metrics',
      ],
    },
    {
      type: 'category',
      label: 'Design Docs',
      items: [
        'design_docs/architecture',
        'design_docs/disagg_serving',
        'design_docs/distributed_runtime',
      ],
    },
    {
      type: 'category',
      label: 'Reference',
      items: [
        'reference/cli',
        'reference/glossary',
      ],
    },
  ],
};

export default sidebars;
```

---

## Content Migration

### Automated Conversion Process

```bash
# 1. Convert RST files to Markdown
find ../sphinx -name "*.rst" -exec pandoc {} -f rst -t gfm -o {}.md \;

# 2. Copy Markdown files (already compatible)
cp -r ../sphinx/**/*.md docs/

# 3. Run migration script for Sphinx-specific syntax
python scripts/migrate_content.py
```

### Migration Script

Create `scripts/migrate_content.py`:

```python
#!/usr/bin/env python3
"""Migrate Sphinx markdown syntax to Docusaurus MDX."""

import re
import os
from pathlib import Path

REPLACEMENTS = [
    # Admonitions: MyST -> Docusaurus
    (r'```{note}', ':::note'),
    (r'```{warning}', ':::warning'),
    (r'```{tip}', ':::tip'),
    (r'```{caution}', ':::caution'),
    (r'```{danger}', ':::danger'),
    (r'```', ':::'),  # Close admonitions
    
    # References
    (r':ref:`([^`]+)`', r'[\1](\1.md)'),
    
    # Code blocks with sphinx-specific options
    (r'```{code-block} (\w+)', r'```\1'),
    
    # Remove toctree directives (handled by sidebars.ts)
    (r'```{toctree}[\s\S]*?```', ''),
]

def migrate_file(filepath: Path):
    content = filepath.read_text()
    
    for pattern, replacement in REPLACEMENTS:
        content = re.sub(pattern, replacement, content)
    
    # Write back
    filepath.write_text(content)
    print(f"Migrated: {filepath}")

def main():
    docs_dir = Path("docs")
    for md_file in docs_dir.rglob("*.md"):
        migrate_file(md_file)

if __name__ == "__main__":
    main()
```

### Manual Fixes Required

| Sphinx Feature | Docusaurus Equivalent |
|----------------|----------------------|
| `.. include::` directives | Import MDX components |
| `.. toctree::` | `sidebars.ts` configuration |
| `:doc:` references | Standard markdown links |
| `{guilabel}`, `{menuselection}` | Bold text or custom component |
| Sphinx tabs | `@docusaurus/theme-classic` tabs or MDX |

---

## Versioning Strategy

### Docusaurus Native Versioning

Docusaurus handles versioning automatically with the `docs:version` command.

**How it works:**

```bash
# When ready to release version 0.4.0:
npm run docusaurus docs:version 0.4.0

# This creates:
# - versioned_docs/version-0.4.0/  (snapshot of docs/)
# - versioned_sidebars/version-0.4.0-sidebars.json
# - Updates versions.json: ["0.4.0", "0.3.0", ...]
```

**Version Structure:**
```
docs/docusaurus/
├── docs/                           # "current" (dev) version
├── versioned_docs/
│   ├── version-0.4.0/              # Release 0.4.0
│   ├── version-0.3.0/              # Release 0.3.0
│   └── version-0.2.0/              # Release 0.2.0
├── versioned_sidebars/
│   ├── version-0.4.0-sidebars.json
│   ├── version-0.3.0-sidebars.json
│   └── version-0.2.0-sidebars.json
└── versions.json                   # ["0.4.0", "0.3.0", "0.2.0"]
```

**Configuration in `docusaurus.config.ts`:**

```typescript
docs: {
  lastVersion: 'current',
  versions: {
    current: {
      label: 'dev',
      path: 'dev',
      banner: 'unreleased',
    },
    '0.4.0': {
      label: '0.4.0 (latest)',
      path: 'latest',
    },
    '0.3.0': {
      label: '0.3.0',
      path: '0.3.0',
    },
  },
},
```

**URL Structure:**
```
/dev/           → Current development docs
/latest/        → Latest stable (0.4.0)
/0.3.0/         → Archived version
/0.2.0/         → Archived version
```

---

## Theme & Styling

### NVIDIA Branding with Custom CSS

Create `src/css/custom.css`:

```css
/**
 * NVIDIA Dynamo Documentation Theme
 * Custom styling to match NVIDIA branding
 */

:root {
  /* NVIDIA Brand Colors */
  --ifm-color-primary: #76b900;
  --ifm-color-primary-dark: #6aa600;
  --ifm-color-primary-darker: #5f9400;
  --ifm-color-primary-darkest: #4d7a00;
  --ifm-color-primary-light: #84c219;
  --ifm-color-primary-lighter: #93cb33;
  --ifm-color-primary-lightest: #a8d64d;
  
  /* Navigation */
  --ifm-navbar-background-color: #1a1a1a;
  --ifm-navbar-link-color: #ffffff;
  --ifm-navbar-link-hover-color: #76b900;
  
  /* Code blocks */
  --ifm-code-font-size: 95%;
  --docusaurus-highlighted-code-line-bg: rgba(118, 185, 0, 0.1);
  
  /* Sidebar */
  --ifm-menu-color-active: #76b900;
}

/* Dark mode */
[data-theme='dark'] {
  --ifm-background-color: #1a1a1a;
  --ifm-background-surface-color: #242424;
  --ifm-color-primary: #76b900;
}

/* Navbar styling */
.navbar {
  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.1);
}

.navbar__title {
  font-weight: 700;
}

/* Footer styling */
.footer {
  background-color: #1a1a1a;
}

.footer__link-item {
  color: #b0b0b0;
}

.footer__link-item:hover {
  color: #76b900;
}

/* Admonitions */
.alert--note {
  --ifm-alert-background-color: rgba(118, 185, 0, 0.1);
  --ifm-alert-border-color: #76b900;
}

/* Version badge */
.badge--secondary {
  background-color: #76b900;
  border-color: #76b900;
}
```

### Logo Assets

Place in `static/img/`:
- `nvidia-logo.svg` - NVIDIA logo for navbar
- `favicon.ico` - Browser favicon

---

## Implementation Steps

### Phase 1: Setup (Day 1-2)

```bash
# 1. Create Docusaurus project
cd /home/jonathan/go/src/dynamo/docs
npx create-docusaurus@latest docusaurus classic --typescript

# 2. Install dependencies
cd docusaurus
npm install @docusaurus/theme-mermaid @docusaurus/plugin-client-redirects

# 3. Apply configuration
# - Update docusaurus.config.ts (see above)
# - Create sidebars.ts
# - Add custom.css

# 4. Test setup
npm run start
# Verify http://localhost:3000 shows default page
```

### Phase 2: Content Migration (Day 3-5)

```bash
# 1. Copy existing markdown content
mkdir -p docs/backends docs/kubernetes docs/guides

# 2. Run conversion scripts
python scripts/migrate_content.py

# 3. Convert index.rst to intro.md
pandoc ../index.rst -f rst -t gfm -o docs/intro.md

# 4. Copy images
cp -r ../images static/img/

# 5. Iteratively fix issues
npm run start  # Check browser for errors
```

### Phase 3: Validation (Day 6-7)

```bash
# 1. Build production site
npm run build

# 2. Check for broken links
npm run serve
# Manually test navigation

# 3. Test version switching
npm run docusaurus docs:version 0.3.0
npm run start
# Verify version dropdown works
```

### Phase 4: Cleanup

```bash
# After validation, remove old Sphinx files:
# - docs/conf.py
# - docs/Makefile
# - docs/index.rst
# - docs/_extensions/
# - docs/_includes/
# - docs/_static/

# Keep docusaurus/ as the new docs root (or move up)
```

---

## Migration Checklist

### Pre-Migration
- [ ] Audit all existing content (pages, images, downloads)
- [ ] Document all Sphinx extensions in use
- [ ] Create redirect map from old URLs to new
- [ ] Set up Docusaurus development environment

### Setup
- [ ] Initialize Docusaurus project
- [ ] Configure `docusaurus.config.ts`
- [ ] Create `sidebars.ts` from toctrees
- [ ] Add NVIDIA custom CSS theme
- [ ] Add logo and favicon

### Content Migration
- [ ] Convert `index.rst` to `intro.md`
- [ ] Migrate all Markdown files
- [ ] Convert RST files to MDX
- [ ] Migrate images to `static/img/`
- [ ] Fix internal links
- [ ] Implement custom components (if needed)

### Validation
- [ ] Test all pages render correctly
- [ ] Verify all internal links work
- [ ] Test code block syntax highlighting
- [ ] Test Mermaid diagrams
- [ ] Test version dropdown (after creating test version)
- [ ] Test mobile responsiveness
- [ ] Run `npm run build` without errors

### Post-Migration
- [ ] Remove old Sphinx configuration files
- [ ] Update `.gitignore` for Docusaurus
- [ ] Update CONTRIBUTING.md for docs workflow
- [ ] Create GitHub Actions workflow (when ready for CI)

---

## Quick Reference

### Commands Cheat Sheet

```bash
# Development
npm run start              # Start dev server (http://localhost:3000)
npm run build              # Build production site
npm run serve              # Serve production build locally
npm run clear              # Clear cache

# Versioning
npm run docusaurus docs:version 0.4.0    # Create version snapshot

# Debugging
npm run build -- --debug   # Build with debug output
```

### File Locations

| What | Where |
|------|-------|
| Main config | `docusaurus.config.ts` |
| Sidebar nav | `sidebars.ts` |
| Current docs | `docs/` |
| Versioned docs | `versioned_docs/` |
| Custom CSS | `src/css/custom.css` |
| Static files | `static/` |
| Build output | `build/` |

---

*Document updated: January 2026*
