# CI Filter Patterns - See FILTERS.md for documentation
#
# Filters that trigger CI jobs:
#   core     -> dynamo build-test, all backend builds (vllm/sglang/trtllm), deploy tests
#   operator -> operator build and test
#   deploy   -> deploy-test-vllm-disagg-router
#   vllm     -> vllm build and test
#   sglang   -> sglang build and test
#   trtllm   -> trtllm build and test
#
# Filters for coverage only (no CI triggered):
#   docs, examples, ignore, planner

all:
  - '**'

docs:
  - 'docs/**'
  - '**/*.md'
  - '**/*.rst'
  - '**/*.txt'
  - '**/.gitignore'
  - '**/.helmignore'
  - '**/.gitattributes'
  - 'LICENSE'
  - 'CODEOWNERS'

examples:
  - 'recipes/**'
  - 'examples/**'
  - 'benchmarks/**'
  - '.devcontainer/**'
  - 'deploy/discovery/**'
  - 'deploy/inference-gateway/**'
  - 'deploy/observability/**'
  - 'deploy/pre-deployment/**'

ignore:
  - '.lycheeignore'
  - '.pre-commit-config.yaml'
  - '.coderabbit.yaml'
  - '.clang-format'
  - 'dynamo.code-workspace'
  - 'deploy/*'
  - 'launch/**'
  - '.github/scripts/**'
  - '.github/ISSUE_TEMPLATE/**'
  - '.github/pull_request_template.md'
  - '.github/release.yml'
  - '.github/copy-pr-bot.yaml'
  - '.github/dco.yml'
  - 'container/Dockerfile.aws'
  - 'container/Dockerfile.docs'
  - 'container/Dockerfile.epp'
  - 'container/Dockerfile.frontend'
  - 'container/Dockerfile.local_dev'
  - 'container/run.sh'
  - 'container/use-sccache.sh'

ci: &ci
  - '.github/workflows/**'
  - '.github/filters.yaml'
  - '.github/actions/**'
  - '.github/scripts/parse_buildkit_output.py'

core_code: &core_code
  - 'lib/**'
  - 'tests/**'
  - 'components/src/dynamo/router/**'
  - 'components/src/dynamo/mocker/**'
  - 'components/src/dynamo/frontend/**'
  - 'components/src/dynamo/common/**'
  - '*.toml'
  - '*.lock'
  - '*.py'
  - '*.rs'
  - 'scripts/report_pytest_markers.py'
  - '!**/*.md'
  - '!**/*.rst'
  - '!**/*.txt'

core_container: &core_container
  - 'container/build.sh'
  - 'container/deps/*'
  - '.cargo/config.toml'

operator: &operator
  - 'deploy/operator/**'
  - 'deploy/operator/.*'

deploy:
  - *operator
  - 'deploy/cloud/helm/**'
  - 'deploy/utils/**'


planner:
  - 'components/src/dynamo/planner/**'
  - 'tests/planner/**'

vllm_code: &vllm_code
  - *core_code
  - 'examples/backends/vllm/**'
  - 'components/src/dynamo/vllm/**'

vllm_container: &vllm_container
  - *core_container
  - 'container/Dockerfile.vllm'
  - 'container/deps/requirements.vllm.txt'
  - 'container/deps/vllm/**'

vllm_all:
  - *vllm_code
  - *vllm_container

sglang_code: &sglang_code
  - *core_code
  - 'examples/backends/sglang/**'
  - 'components/src/dynamo/sglang/**'

sglang_container: &sglang_container
  - *core_container
  - 'container/Dockerfile.sglang'

sglang_all:
  - *sglang_code
  - *sglang_container

trtllm_code: &trtllm_code
  - *core_code
  - 'examples/backends/trtllm/**'
  - 'components/src/dynamo/trtllm/**'

trtllm_container: &trtllm_container
  - *core_container
  - 'container/Dockerfile.trtllm'
  - 'container/build_trtllm_wheel.sh'
  - 'container/deps/trtllm/**'

trtllm_all:
  - *trtllm_code
  - *trtllm_container