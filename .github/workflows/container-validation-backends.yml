# SPDX-FileCopyrightText: Copyright (c) 2024-2025 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
# SPDX-License-Identifier: Apache-2.0

name: NVIDIA Dynamo Backends Github Validation

on:
  push:
    branches:
      - main
      - "pull-request/[0-9]+"

concurrency:
  group: ${{ github.workflow }}-build-test-${{ github.ref_name || github.run_id }}
  cancel-in-progress: ${{ github.ref != 'refs/heads/main' }}

jobs:
  build-test-vllm:
    runs-on: gpu-l40-amd64
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Dynamo Backend Validation
        uses: ./.github/actions/backends-build-composite-action
        with:
          framework: vllm
          pytest_marks: "e2e and vllm and gpu_1 and not slow"
          target: runtime

  build-test-sglang:
    runs-on: gpu-l40-amd64
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Dynamo Backend Validation
        uses: ./.github/actions/backends-build-composite-action
        with:
          framework: sglang
          pytest_marks: "e2e and sglang and gpu_1 and not slow"
          target: runtime
    