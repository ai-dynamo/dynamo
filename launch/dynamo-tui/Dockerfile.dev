# SPDX-FileCopyrightText: Copyright (c) 2025 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
# SPDX-License-Identifier: Apache-2.0

# Simple Dockerfile for building and testing dynamo-tui on macOS
FROM rust:1.90.0-slim

# Install dependencies needed for building
RUN apt-get update && apt-get install -y \
    pkg-config \
    libssl-dev \
    curl \
    git \
    build-essential \
    protobuf-compiler \
    && rm -rf /var/lib/apt/lists/*

# Set working directory
WORKDIR /workspace

# Copy Cargo files first for better caching
COPY Cargo.toml Cargo.lock ./
COPY rust-toolchain.toml ./
COPY README.md ./

# Copy workspace configuration
COPY pyproject.toml ./

# Copy lib directory (needed for dynamo-runtime)
COPY lib/ ./lib/

# Copy launch directory (contains dynamo-tui and dynamo-run)
COPY launch/ ./launch/

# Build the TUI
RUN cargo build -p dynamo-tui --release

# Default command - run the TUI
CMD ["./target/release/dynamo-tui"]

